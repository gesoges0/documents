<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>dBT ä¸­é–“å±¤ï¼šç›®çš„ã‚’æŒã£ãŸå¤‰æ›ã‚¹ãƒ†ãƒƒãƒ—</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kaisei+Decol:wght@400;700&family=Yomogi:wght@400&family=Zen+Kurenaido:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Yomogi', cursive;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            min-height: 100vh;
            padding: 20px;
            color: #334155;
            line-height: 1.6;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #593C47 0%, #F2E63D 50%, #F25C05 100%);
            padding: 30px 40px;
            color: white;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M20 20l10-10v5l-5 5 5 5v5z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
            animation: float 25s infinite linear;
        }
        
        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(-40px, -40px) rotate(360deg); }
        }
        
        .header-content {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        h1 {
            font-family: 'Zen Kurenaido', cursive;
            font-size: 32px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
        }
        
        .date-source {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 30px;
            padding: 40px;
        }
        
        .section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #F2E63D, #F2C53D, #F25C05);
        }
        
        .section-title {
            font-family: 'Zen Kurenaido', cursive;
            font-size: 18px;
            color: #1e40af;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .icon {
            font-size: 24px;
            background: linear-gradient(135deg, #F2C53D, #F25C05);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .hand-drawn-box {
            border: 2px solid #F25C05;
            border-radius: 15px;
            padding: 15px;
            margin: 15px 0;
            background: linear-gradient(135deg, #FFF9E6 0%, #FFFFFF 100%);
            position: relative;
            transform: rotate(-0.5deg);
        }
        
        .hand-drawn-box::after {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            border: 2px dashed #F2C53D;
            border-radius: 15px;
            transform: rotate(1deg);
            z-index: -1;
        }
        
        .highlight {
            background: linear-gradient(120deg, rgba(242, 196, 61, 0.3) 0%, rgba(242, 196, 61, 0.1) 100%);
            padding: 3px 8px;
            border-radius: 6px;
            font-weight: bold;
            color: #593C47;
            border-bottom: 3px solid #F2C53D;
        }
        
        .code-snippet {
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin: 15px 0;
            overflow-x: auto;
            border-left: 4px solid #F25C05;
        }
        
        .do-dont {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            padding: 10px;
            border-radius: 8px;
        }
        
        .do {
            background: rgba(34, 197, 94, 0.1);
            border-left: 4px solid #22c55e;
        }
        
        .dont {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid #ef4444;
        }
        
        .arrow {
            font-size: 20px;
            color: #F25C05;
            margin: 10px 0;
            text-align: center;
        }
        
        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .flow-item {
            background: linear-gradient(135deg, #F2E63D, #F2C53D);
            padding: 10px 15px;
            border-radius: 20px;
            font-weight: bold;
            color: #593C47;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            transform: rotate(-1deg);
            margin: 5px;
            font-size: 12px;
            text-align: center;
        }
        
        .flow-item:nth-child(even) {
            transform: rotate(1deg);
            background: linear-gradient(135deg, #F25C05, #F24405);
            color: white;
        }
        
        .analogy-box {
            background: linear-gradient(135deg, rgba(89, 60, 71, 0.1) 0%, rgba(242, 230, 61, 0.1) 100%);
            border: 2px solid #593C47;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            position: relative;
        }
        
        .analogy-box::before {
            content: 'ğŸ§¬';
            position: absolute;
            top: -10px;
            left: 20px;
            background: white;
            padding: 0 10px;
            font-size: 20px;
        }
        
        .file-tree {
            background: #f1f5f9;
            border: 2px solid #cbd5e1;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin: 15px 0;
        }
        
        .key-point {
            background: linear-gradient(135deg, #F24405, #F25C05);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            transform: rotate(-0.5deg);
            box-shadow: 0 4px 15px rgba(242, 68, 5, 0.3);
        }
        
        .dag-visual {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border: 2px dashed #F25C05;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .molecular-structure {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }
        
        .atom {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #F2E63D, #F2C53D);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #593C47;
            font-size: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .molecule {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #F25C05, #F24405);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 14px;
            box-shadow: 0 4px 15px rgba(242, 68, 5, 0.3);
        }
        
        .connection-line {
            width: 30px;
            height: 2px;
            background: #593C47;
            position: relative;
        }
        
        .verb-highlight {
            background: linear-gradient(135deg, rgba(242, 91, 5, 0.2), rgba(242, 68, 5, 0.1));
            border: 2px solid #F25C05;
            border-radius: 20px;
            padding: 5px 12px;
            margin: 5px;
            display: inline-block;
            font-weight: bold;
            color: #593C47;
            transform: rotate(-1deg);
        }
        
        .verb-highlight:nth-child(even) {
            transform: rotate(1deg);
        }
        
        footer {
            background: #593C47;
            color: white;
            padding: 20px 40px;
            text-align: center;
            font-size: 14px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 24px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 10px;
            }
            
            .molecular-structure {
                flex-direction: column;
            }
            
            .connection-line {
                width: 2px;
                height: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div>
                    <h1>ğŸ§¬ dBT ä¸­é–“å±¤</h1>
                    <p>ç›®çš„ã‚’æŒã£ãŸå¤‰æ›ã‚¹ãƒ†ãƒƒãƒ—</p>
                </div>
                <div class="date-source">
                    <div>ğŸ“… 2025å¹´6æœˆ11æ—¥</div>
                    <div>ğŸ“– å‡ºå…¸: dbt Documentation</div>
                </div>
            </div>
        </header>
        
        <div class="main-content">
            <!-- å·¦ã‚«ãƒ©ãƒ ï¼šæ¦‚å¿µã¨ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼ -->
            <div class="section">
                <h3 class="section-title">
                    <span class="icon">ğŸ§¬</span>
                    åˆ†å­æ§‹é€ ã®å½¢æˆ
                </h3>
                
                <div class="analogy-box">
                    <h4>âš›ï¸ åŸå­ã‹ã‚‰åˆ†å­ã¸</h4>
                    <div class="molecular-structure">
                        <div class="atom">åŸå­</div>
                        <div class="connection-line"></div>
                        <div class="atom">åŸå­</div>
                        <div class="connection-line"></div>
                        <div class="molecule">åˆ†å­</div>
                    </div>
                    <p><strong>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°å±¤ã®åŸå­</strong>ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ã‚ˆã‚Šè¤‡é›‘ã§æ¥ç¶šã•ã‚ŒãŸ<strong>åˆ†å­å½¢çŠ¶</strong>ã‚’ä½œæˆ</p>
                </div>
                
                <div class="key-point">
                    <strong>ğŸ¯ ä¸­é–“å±¤ã®ç›®çš„</strong><br>
                    è¤‡é›‘ãªã‚¿ãƒ³ãƒ‘ã‚¯è³ªã‚„ç´°èƒï¼ˆãƒãƒ¼ãƒˆï¼‰ã«å‘ã‘ã¦ã€ç‰¹å®šã®ç›®çš„ã‚’æŒã£ãŸå¤šæ§˜ãªå½¢ã‚’ä½œæˆ
                </div>
                
                <div class="hand-drawn-box">
                    <h4>ğŸ”„ DAGã®çŸ¢å°å½¢çŠ¶</h4>
                    <div class="dag-visual">
                        <div class="flow-diagram">
                            <div class="flow-item">å¤šæ•°ã®<br>ç‹­ã„æ¦‚å¿µ</div>
                            <span class="arrow">â†’</span>
                            <div class="flow-item">å°‘æ•°ã®<br>åºƒã„æ¦‚å¿µ</div>
                        </div>
                        <p><strong>ã‚½ãƒ¼ã‚¹æº–æ‹ </strong> â†’ <strong>ãƒ“ã‚¸ãƒã‚¹æº–æ‹ </strong></p>
                    </div>
                </div>
                
                <div class="analogy-box">
                    <h4>ğŸ“ è¨­è¨ˆåŸå‰‡</h4>
                    <p><strong>è¤‡æ•°ã®å…¥åŠ›ã€å˜ä¸€ã®å‡ºåŠ›</strong></p>
                    <ul>
                        <li>âœ… è¤‡æ•°ã®çŸ¢å°ãŒå…¥ã‚‹ = è‰¯ã„</li>
                        <li>âŒ è¤‡æ•°ã®çŸ¢å°ãŒå‡ºã‚‹ = å±é™ºä¿¡å·</li>
                    </ul>
                </div>
            </div>
            
            <!-- ä¸­å¤®ã‚«ãƒ©ãƒ ï¼šæ§‹é€ ã¨ãƒ•ã‚¡ã‚¤ãƒ«å‘½å -->
            <div class="section">
                <h3 class="section-title">
                    <span class="icon">ğŸ“</span>
                    æ§‹é€ ã¨å‘½åãƒ‘ã‚¿ãƒ¼ãƒ³
                </h3>
                
                <div class="file-tree">
models/intermediate<br>
â””â”€â”€ finance<br>
    â”œâ”€â”€ _int_finance__models.yml<br>
    â””â”€â”€ int_payments_pivoted_to_orders.sql
                </div>
                
                <h4 class="highlight">ğŸ“‹ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ </h4>
                
                <div class="do">
                    <span>âœ…</span>
                    <span><strong>ãƒ“ã‚¸ãƒã‚¹ã‚°ãƒ«ãƒ¼ãƒ—åŸºæº–</strong> - ã‚½ãƒ¼ã‚¹ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ãªãäº‹æ¥­é ˜åŸŸã§åˆ†é¡</span>
                </div>
                
                <div class="hand-drawn-box">
                    <h4>ğŸ·ï¸ ãƒ•ã‚¡ã‚¤ãƒ«å‘½åè¦å‰‡</h4>
                    <div class="do">
                        <span>âœ…</span>
                        <code>int_[entity]s_[verb]s.sql</code>
                    </div>
                    <p><strong>å‹•è©</strong>ã§å¤‰æ›ã®å†…å®¹ã‚’è¡¨ç¾ï¼š</p>
                    <div class="verb-highlight">pivoted</div>
                    <div class="verb-highlight">aggregated_to_user</div>
                    <div class="verb-highlight">joined</div>
                    <div class="verb-highlight">fanned_out_by_quantity</div>
                    <div class="verb-highlight">funnel_created</div>
                </div>
                
                <div class="key-point">
                    <strong>ğŸ’¡ å‘½åã®ãƒã‚¤ãƒ³ãƒˆ</strong><br>
                    SQLã‚’çŸ¥ã‚‰ãªã„äººã§ã‚‚ä½•ãŒèµ·ã“ã£ã¦ã„ã‚‹ã‹ç†è§£ã§ãã‚‹æ˜ç¢ºæ€§ã‚’é‡è¦–
                </div>
                
                <div class="hand-drawn-box">
                    <h4>âš ï¸ æ—©æœŸæœ€é©åŒ–ã®æ³¨æ„</h4>
                    <p>ãƒãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«ãŒ10å€‹æœªæº€ã§å•é¡ŒãŒãªã„å ´åˆã¯ã€ã‚µãƒ–ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ä¸è¦</p>
                    <p><strong>ç›®æ¨™ï¼š</strong> å˜ä¸€ã®çœŸå®Ÿã®ã‚½ãƒ¼ã‚¹</p>
                </div>
            </div>
            
            <!-- å³ã‚«ãƒ©ãƒ ï¼šå¤‰æ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç”¨é€” -->
            <div class="section">
                <h3 class="section-title">
                    <span class="icon">ğŸ”§</span>
                    å¤‰æ›ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç”¨é€”
                </h3>
                
                <h4 class="highlight">âœ¨ ä¸»è¦ãªç”¨é€”</h4>
                
                <div class="do">
                    <span>âœ…</span>
                    <span><strong>æ§‹é€ çš„ç°¡ç´ åŒ–</strong> - 4-6å€‹ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’é©åˆ‡ã«çµ„ã¿åˆã‚ã›</span>
                </div>
                
                <div class="do">
                    <span>âœ…</span>
                    <span><strong>ç²’åº¦ã®å†èª¿æ•´</strong> - ãƒ•ã‚¡ãƒ³ã‚¢ã‚¦ãƒˆã‚„é›†ç´„ã§é©åˆ‡ãªè¤‡åˆç²’åº¦ã«</span>
                </div>
                
                <div class="do">
                    <span>âœ…</span>
                    <span><strong>è¤‡é›‘ãªæ“ä½œã®åˆ†é›¢</strong> - ç†è§£å›°é›£ãªãƒ­ã‚¸ãƒƒã‚¯ã‚’ç‹¬ç«‹ã—ãŸãƒ¢ãƒ‡ãƒ«ã«</span>
                </div>
                
                <div class="code-snippet">
-- int_payments_pivoted_to_orders.sql
{%- set payment_methods = [
  'bank_transfer','credit_card',
  'coupon','gift_card'
] -%}

with
payments as (
  select * from {{ ref('stg_stripe__payments') }}
),
pivot_and_aggregate_payments_to_order_grain as (
  select
    order_id,
    {% for payment_method in payment_methods -%}
    sum(case
      when payment_method = '{{ payment_method }}'
        and status = 'success'
      then amount else 0
    end) as {{ payment_method }}_amount,
    {%- endfor %}
    sum(case when status = 'success' 
        then amount end) as total_amount
  from payments
  group by 1
)
select * from pivot_and_aggregate_payments_to_order_grain
                </div>
                
                <div class="hand-drawn-box">
                    <h4>ğŸª CTEå‘½åã®é‡è¦æ€§</h4>
                    <p><code>pivot_and_aggregate_payments_to_order_grain</code></p>
                    <p>SQLã‚’çŸ¥ã‚‰ãªã„ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼ã§ã‚‚ç›®çš„ãŒç†è§£ã§ãã‚‹</p>
                </div>
            </div>
            
            <!-- ä¸‹æ®µï¼šãƒãƒ†ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ -->
            <div class="section">
                <h3 class="section-title">
                    <span class="icon">ğŸ’¾</span>
                    ãƒãƒ†ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥
                </h3>
                
                <div class="dont">
                    <span>âŒ</span>
                    <span><strong>ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å…¬é–‹</strong> - ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ã‚¹ã‚­ãƒ¼ãƒã«ã¯é…ç½®ã—ãªã„</span>
                </div>
                
                <h4 class="highlight">ğŸ’¡ æ¨å¥¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³</h4>
                
                <div class="do">
                    <span>âœ…</span>
                    <span><strong>ã‚¨ãƒ•ã‚§ãƒ¡ãƒ©ãƒ«åŒ–</strong> - ã‚·ãƒ³ãƒ—ãƒ«ã•ã‚’é‡è¦–ã€ã‚¦ã‚§ã‚¢ãƒã‚¦ã‚¹ã«ä¸è¦ãªãƒ¢ãƒ‡ãƒ«ã‚’æ®‹ã•ãªã„</span>
                </div>
                
                <div class="do">
                    <span>âœ…</span>
                    <span><strong>ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ¼ãƒã®ãƒ“ãƒ¥ãƒ¼</strong> - ã‚ˆã‚Šå …ç‰¢ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒå®¹æ˜“</span>
                </div>
                
                <div class="key-point">
                    <strong>ğŸ—ï¸ ã‚¦ã‚§ã‚¢ãƒã‚¦ã‚¹å‡ºåŠ›ã®UX</strong><br>
                    ã‚¹ã‚­ãƒ¼ãƒã€ãƒ†ãƒ¼ãƒ–ãƒ«ã€ãƒ“ãƒ¥ãƒ¼ã‚‚é‡è¦ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã®ä¸€éƒ¨
                </div>
                
                <div class="hand-drawn-box">
                    <h4>ğŸ” ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h4>
                    <p><strong>ã‚¨ãƒ•ã‚§ãƒ¡ãƒ©ãƒ«:</strong> è£œé–“ã•ã‚Œã‚‹ãŸã‚è¡¨ç¤ºå›°é›£</p>
                    <p><strong>ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚­ãƒ¼ãƒãƒ“ãƒ¥ãƒ¼:</strong> ç‹¬ç«‹ã—ã¦ç¢ºèªå¯èƒ½</p>
                </div>
            </div>
            
            <!-- ä¸­å¤®ä¸‹æ®µï¼šå®Ÿè£…ä¾‹ -->
            <div class="section">
                <h3 class="section-title">
                    <span class="icon">âš™ï¸</span>
                    å®Ÿè£…ã¨è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³
                </h3>
                
                <div class="analogy-box">
                    <h4>ğŸ¯ å¤‰æ›ã®ä¾‹</h4>
                    <p><strong>æ±ºæ¸ˆãƒ‡ãƒ¼ã‚¿ã®ãƒ”ãƒœãƒƒãƒˆ</strong></p>
                    <div class="flow-diagram">
                        <div class="flow-item">payment_method<br>åˆ¥ã®è¡Œ</div>
                        <span class="arrow">â†’</span>
                        <div class="flow-item">orderç²’åº¦ã®<br>ã‚«ãƒ©ãƒ </div>
                    </div>
                </div>
                
                <div class="hand-drawn-box">
                    <h4>ğŸ§® Jinjaã®æ´»ç”¨</h4>
                    <p>DRYåŸå‰‡ã‚’å˜ä¸€ãƒ¢ãƒ‡ãƒ«å†…ã§ã‚‚é©ç”¨</p>
                    <ul>
                        <li>æ”¯æ‰•æ–¹æ³•ã®å‹•çš„ãƒ«ãƒ¼ãƒ—</li>
                        <li>ä¿å®ˆæ€§ã®å‘ä¸Š</li>
                        <li>ã‚³ãƒ¼ãƒ‰ã®é‡è¤‡å‰Šæ¸›</li>
                    </ul>
                </div>
                
                <div class="key-point">
                    <strong>ğŸ“Š å…·ä½“ä¾‹ã®åŠ¹æœ</strong><br>
                    10å€‹ã®çµåˆã‚’å«ã‚€ãƒãƒ¼ãƒˆã‚ˆã‚Šã‚‚ã€2å€‹ã®ä¸­é–“ãƒ¢ãƒ‡ãƒ«ã®çµåˆã®æ–¹ãŒèª­ã¿ã‚„ã™ã„
                </div>
                
                <div class="dag-visual">
                    <h4>ç†æƒ³çš„ãªDAGå½¢çŠ¶</h4>
                    <div style="font-size: 24px; margin: 10px 0;">
                        â–¶ï¸ å³å‘ãã®çŸ¢å°
                    </div>
                    <p>å¤šæ•°ãƒ»ç‹­ã„ â†’ å°‘æ•°ãƒ»åºƒã„ â†’ ãƒãƒ¼ãƒˆ</p>
                </div>
            </div>
            
            <!-- å³ä¸‹æ®µï¼šãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ -->
            <div class="section">
                <h3 class="section-title">
                    <span class="icon">ğŸ¯</span>
                    ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
                </h3>
                
                <div class="key-point">
                    <strong>ğŸª ãƒ‡ãƒ¼ã‚¿ã‚¬ãƒãƒŠãƒ³ã‚¹</strong><br>
                    é©åˆ‡ãªæ¨©é™ç®¡ç†ã¨ç™ºè¦‹å¯èƒ½æ€§ã®åˆ¶å¾¡
                </div>
                
                <div class="hand-drawn-box">
                    <h4>ğŸ” 3ã¤ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</h4>
                    <ol>
                        <li><strong>DAG</strong> - ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã®è¦–è¦šåŒ–</li>
                        <li><strong>ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ </strong> - ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã®çµ„ç¹”</li>
                        <li><strong>ã‚¦ã‚§ã‚¢ãƒã‚¦ã‚¹å‡ºåŠ›</strong> - ã‚¹ã‚­ãƒ¼ãƒã¨ãƒ†ãƒ¼ãƒ–ãƒ«</li>
                    </ol>
                </div>
                
                <div class="analogy-box">
                    <h4>ğŸ—ï¸ è¤‡é›‘ã•ã®åˆ†æ•£</h4>
                    <p>ãƒãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«ã‹ã‚‰è¤‡é›‘ã•ã‚’å–ã‚Šé™¤ãã€ä¸­é–“å±¤ã§ç®¡ç†</p>
                    <div class="flow-diagram">
                        <div class="flow-item">èª­ã¿ã‚„ã™ã•</div>
                        <div class="flow-item">æŸ”è»Ÿæ€§</div>
                        <div class="flow-item">ãƒ†ã‚¹ãƒˆç¯„å›²</div>
                        <div class="flow-item">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ<br>æ´å¯Ÿ</div>
                    </div>
                </div>
                
                <div class="do">
                    <span>âœ…</span>
                    <span><strong>ç²’åº¦ã®ç¢ºèª</strong> - ä»–ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨æ··åˆã™ã‚‹å‰ã«ç²’åº¦ã®æ­£ç¢ºæ€§ã‚’ç¢ºèª</span>
                </div>
                
                <div class="do">
                    <span>âœ…</span>
                    <span><strong>ãƒ­ã‚¸ãƒƒã‚¯ã®åˆ†é›¢</strong> - è¤‡é›‘ãªå¤‰æ›ã‚’ç‹¬ç«‹ã•ã›ã¦ãƒ‡ãƒãƒƒã‚°ã¨æ”¹å–„ã‚’å®¹æ˜“ã«</span>
                </div>
                
                <div class="hand-drawn-box">
                    <h4>ğŸ¨ é–‹ç™ºå“²å­¦</h4>
                    <p><strong>dbtã¯å¸¸ã«è¤‡é›‘ã•ã«ã‚·ãƒ³ãƒ—ãƒ«ã•ã‚’ã‚‚ãŸã‚‰ã™ãƒ„ãƒ¼ãƒ«</strong></p>
                </div>
            </div>
        </div>
        
        <footer>
            <p>ğŸ“š å‡ºå…¸: dbt Documentation - Best Practices: How We Structure Our dbt Projects</p>
            <p>ğŸŒ URL: https://docs.getdbt.com/best-practices/how-we-structure/3-intermediate</p>
        </footer>
    </div>
</body>
</html>
